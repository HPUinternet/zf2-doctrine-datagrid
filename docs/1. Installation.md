# HPU Datagrid Module - Installation
So you've decided to try the DataGrid module, awesome! Here are some pre requirements for a more enjoyable installation process. 

1. You have composer available
2. You are currently working on a ZF2 project with at least one Doctrine 2 Entity
3. You'll get extra credit if your DataSource contains actual data

## Installing

1. Run `composer require hpu/zf2-doctrine-datagrid` to add the DataGrid module to your composer.json
2. Enable the Datagrid Module in your ZF2 application by adding `Wms\Admin\DataGrid` to your application.config.php
3. Add configuration for your controller ([show example](# Controller configuration))
4. Call the Controller plugin in your controller ([show detailed help](2. Usage and configuration.md))
5. Echo the data using the DataGrid viewHelper

## Detailed installation
### Controller configuration
Sadly, we must help the DataGrid by telling it what Entity the data should be grabbed from. This is done through configuration.
In this example, we'll take the default [zend-skeleton-application](https://github.com/zendframework/ZendSkeletonApplication), which has an Application module, containing the following configuration:

File: `module/Application/config/module.config.php`


    <?php
        // Zend disclaimer
        namespace Application;
            
        return array(
            // Other configuration
            'controllers' => array(
                    'invokables' => array(
                        'Application\Controller\Index' => Controller\IndexController::class
                    ),
                ),
            // Other configuration
        );
            
Aha! we will need the Alias name of you controller, in this case: `Application\Controller\Index`. Now create a new file called datagrid.config.php so we can get to work

File: `module/Application/config/datagrid.config.php`

    <?php
        namespace Application;
        
        return array(
            'wms-datagrid' => array(
                'Application\Controller\Index' => array(
                    'entityName' => 'YOUR\DOCTRINE\ENTITY\NAMESPACE',
                    'defaultColumns' => array('id'),
                ),
            ),
        );
        
That's it! don't forget to edit the entityName to your Entity Namespace. Of course  you can configure much more than this minimalistic array. To do so, [visit the usage and configuration manual](2. Usage and configuration.md)

### Calling the controller plugin
Just like the controller configuration example, we are using the [zend-skeleton-application](https://github.com/zendframework/ZendSkeletonApplication) as an example. 
In the previous step, you have configured an entity for your controller. Now lets see that controller code:

File (before): `module/Application/src/Application/Controller/IndexController.php`

    <?php
        // Zend disclaimer
        namespace Application\Controller;
        
        use Zend\Mvc\Controller\AbstractActionController;
        use Zend\View\Model\ViewModel;
        
        class IndexController extends AbstractActionController
        {
            public function indexAction()
            {
                return new ViewModel();
            }
        }

The DataGrid uses an controller plugin to hook you up with the retrieved data, but you should be in control when to return the datagrid data.
To to so, change the controller like so:

File (after): `module/Application/src/Application/Controller/IndexController.php`

    <?php
        // Zend disclaimer
        namespace Application\Controller;
        
        use Zend\Mvc\Controller\AbstractActionController;
        use Zend\View\Model\ViewModel;
        
        /**
         * @method \Wms\Admin\DataGrid\Controller\Plugin\DataGridPlugin DataGridPlugin()
         */
        class IndexController extends AbstractActionController
        {
            public function indexAction()
            {
                return new ViewModel(array(
                    'table' => $this->DataGridPlugin()->getTable($this->params()->fromQuery())
                ));
            }
        }

### Using the viewHelper
So we've setup the controller configuration and allowed data to be become available in our view.
The only thing that's left to do is converting the data into HTML. We've build a special viewHelper for this job. Go ahead! call it like this:

File: `module/Application/view/application/index/index.phtml`

    <?= $this->DataGridTable($table); ?>
    
Note that the $table variable is the named variable we've inserted into our ViewModel.

Optionally, the view helper will accept an array of table features you may want to enable / disable, things like searching, pagination etc.
[visit the usage and configuration manual](2. Usage and configuration.md) to learn more about this configuration.